---
id: crear-una-validacion-email-registro-aplicacion
title: Crear una Validación de Email de Registro de Aplicación
description: Crea una validación de email para un registro de aplicación para verificar direcciones de email de usuarios
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

### Endpoint

```
POST https://api.verifik.co/v2/email-validations/app-registration
```

Este endpoint crea un proceso de validación de email específicamente para usuarios que están en medio de un flujo de registro de aplicación. Vincula automáticamente la validación de email al registro de aplicación del usuario y maneja la carga de créditos para tu plan SmartEnroll. Una respuesta exitosa (200) indica que Verifik ha enviado un email con un OTP que se usará para completar el proceso de verificación de email.

:::warning
El Token JWT que debes usar al crear `Validaciones de Email de Registro de Aplicación` se proporciona desde el `Registro de Aplicación` en creación. Debes usar el token devuelto al crear un [Registro de Aplicación](/verifik-es/resources/registros-aplicacion/crear-un-registro-aplicacion) para autenticar esta solicitud.
:::

### Headers

| Name          | Value              |
| ------------- | ------------------ |
| Content-Type  | `application/json` |
| Authorization | `Bearer <token>`   |

### Params

| Name               | Type    | Required | Description                                                                                                                                                                        |
| ------------------ | ------- | -------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `project`          | string  | Yes      | El ID del proyecto donde se realizará esta validación de email. Este es el `_id` generado al crear un proyecto                                                                     |
| `validationMethod` | string  | Yes      | Define cómo se validará el email. Debe ser `manual` o `verificationCode`                                                                                                           |
| `email`            | string  | Yes      | La dirección de email que será validada. Este campo es requerido y se convertirá automáticamente a minúsculas y se eliminarán los espacios en blanco                               |
| `type`             | string  | Yes      | El tipo de proceso para el cual es esta validación de email. Debe ser uno de: `validation`, `login`, `onboarding`, o `oneTimeLink`                                                 |
| `expiresAt`        | string  | No       | Marca de tiempo opcional cuando expira el código OTP. Si no se proporciona, se establecerá un tiempo de expiración por defecto. Formato: ISO 8601 (ej: `2024-12-31T23:59:59.000Z`) |
| `redirectUrl`      | string  | No       | URL opcional donde los usuarios serán redirigidos después de completar el proceso de validación de email                                                                           |
| `webhookUrl`       | string  | No       | URL de webhook externa opcional para recibir notificaciones en tiempo real sobre cambios de estado de validación                                                                   |
| `requires2FA`      | boolean | No       | Booleano opcional que indica si se requiere autenticación de dos factores. Por defecto: `false`                                                                                    |
| `ipAddress`        | string  | No       | Dirección IP opcional del usuario que solicita la validación de email                                                                                                              |

#### Validation Method Values

| Value              | Description                                              |
| ------------------ | -------------------------------------------------------- |
| `verificationCode` | Envía código OTP por email para verificación del usuario |
| `manual`           | Proceso de verificación manual sin OTP                   |

#### Type Values

| Value         | Description                                                               |
| ------------- | ------------------------------------------------------------------------- |
| `onboarding`  | Proceso de registro de usuario (recomendado para registros de aplicación) |
| `validation`  | Proceso general de validación de email                                    |
| `login`       | Proceso de autenticación de usuario                                       |
| `oneTimeLink` | Validación de enlace de un solo uso                                       |

### Request

<Tabs>
  <TabItem value="node" label="Node.js">

```javascript
const fetch = require("node-fetch");

async function run() {
	const res = await fetch("https://api.verifik.co/v2/email-validations/app-registration", {
		method: "POST",
		headers: {
			"Content-Type": "application/json",
			Authorization: `Bearer ${process.env.VERIFIK_TOKEN}`,
		},
		body: JSON.stringify({
			project: "6266193db77ccc8111730c90",
			validationMethod: "verificationCode",
			email: "user@example.com",
			type: "onboarding",
		}),
	});
	console.log(await res.json());
}

run();
```

  </TabItem>
  <TabItem value="php" label="PHP">

```php
<?php
$ch = curl_init("https://api.verifik.co/v2/email-validations/app-registration");
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    "Content-Type: application/json",
    "Authorization: Bearer " . getenv("VERIFIK_TOKEN")
]);
$body = json_encode([
    "project" => "6266193db77ccc8111730c90",
    "validationMethod" => "verificationCode",
    "email" => "user@example.com",
    "type" => "onboarding"
]);
curl_setopt($ch, CURLOPT_POSTFIELDS, $body);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$response = curl_exec($ch);
curl_close($ch);
echo $response;
```

  </TabItem>
  <TabItem value="python" label="Python">

```python
import os, requests

url = "https://api.verifik.co/v2/email-validations/app-registration"
headers = {
    "Content-Type": "application/json",
    "Authorization": f"Bearer {os.getenv('VERIFIK_TOKEN')}"
}
payload = {
    "project": "6266193db77ccc8111730c90",
    "validationMethod": "verificationCode",
    "email": "user@example.com",
    "type": "onboarding"
}
r = requests.post(url, json=payload, headers=headers)
print(r.json())
```

  </TabItem>
  <TabItem value="go" label="Go">

```go
package main

import (
    "bytes"
    "encoding/json"
    "fmt"
    "net/http"
    "os"
)

func main() {
    payload := map[string]interface{}{
        "project": "6266193db77ccc8111730c90",
        "validationMethod": "verificationCode",
        "email": "user@example.com",
        "type": "onboarding",
    }
    b, _ := json.Marshal(payload)
    req, _ := http.NewRequest("POST", "https://api.verifik.co/v2/email-validations/app-registration", bytes.NewBuffer(b))
    req.Header.Set("Content-Type", "application/json")
    req.Header.Set("Authorization", "Bearer "+os.Getenv("VERIFIK_TOKEN"))
    resp, _ := http.DefaultClient.Do(req)
    defer resp.Body.Close()
    var out map[string]interface{}
    json.NewDecoder(resp.Body).Decode(&out)
    fmt.Println(out)
}
```

  </TabItem>
</Tabs>

### Response

<Tabs>
  <TabItem value="200" label="200">

```json
{
	"data": {
		"status": "sent",
		"validationMethod": "verificationCode",
		"extraParams": [],
		"type": "onboarding",
		"requires2FA": false,
		"deleted": false,
		"_id": "65c28d66c3abd708cc9b12e2",
		"email": "user@example.com",
		"project": "6266193db77ccc8322530c90",
		"projectFlow": "658ed28b02589f325134d7b78",
		"ipAddress": "4.246.194.90",
		"emailData": {
			"firstName": "John",
			"title": "Verifik Client App",
			"projectName": "Verifik Client App",
			"contactEmail": "support@verifik.co",
			"logo": "https://cdn.verifik.co/access/verifikprojectlogo.png",
			"authLink": "https://access.verifik.co/sign-up/6266193db77ccc8111730c90?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&otp="
		},
		"otp": "$2a$10$MCdw130G.RbW4je9Uj2MvuSTzm7.raG23f0Zaasda0FKC1Gl98r0s4D1m",
		"expiresAt": "2024-02-06T19:59:58.000Z",
		"client": "613375a1eab2fe01237f81e2",
		"updatedAt": "2024-02-06T19:49:59.397Z",
		"createdAt": "2024-02-06T19:49:59.397Z",
		"__v": 0,
		"existing": false,
		"sent": true
	}
}
```

  </TabItem>
  <TabItem value="409" label="409">

```json
{
	"message": "missing project\n. missing validationMethod\n. missing email\n. missing type",
	"code": "MissingParameter"
}
```

  </TabItem>
  <TabItem value="409-email" label="409 (Formato de Email Inválido)">

```json
{
	"message": "Invalid email format",
	"code": "MissingParameter"
}
```

  </TabItem>
  <TabItem value="404-project" label="404 (Proyecto No Encontrado)">

```json
{
	"code": "project_not_found",
	"message": "404:project_not_found"
}
```

  </TabItem>
  <TabItem value="404-flow" label="404 (Flujo de Proyecto No Encontrado)">

```json
{
	"code": "projectFlow_not_found",
	"message": "404:projectFlow_not_found"
}
```

  </TabItem>
  <TabItem value="404-security" label="404 (Seguridad No Establecida)">

```json
{
	"code": "security_not_set",
	"message": "404:security_not_set"
}
```

  </TabItem>
</Tabs>

### Notes

-   **Vinculación de Registro de Aplicación**: Este endpoint vincula automáticamente la validación de email al registro de aplicación del usuario usando el `appRegistrationId` del token de autenticación.
-   **Carga de Créditos**: Cada solicitud de validación de email consume créditos de tu plan SmartEnroll (manejado automáticamente).
-   **Datos de Email Mejorados**: El sistema pobla automáticamente datos de email adicionales incluyendo el nombre de pila del usuario de su validación de información si está disponible.
-   **Generación de Enlace de Autenticación**: Para flujos de incorporación, el sistema genera un token JWT seguro y un enlace de autenticación para una experiencia de usuario fluida.
-   **Prevención de Duplicados**: Si ya existe una validación de email activa para el mismo email, flujo de proyecto y tipo, el sistema reenviará el OTP existente en lugar de crear uno nuevo.
-   **Características de Seguridad**: El sistema valida políticas de seguridad de email y requisitos de verificación de identidad basados en la configuración de tu flujo de proyecto.
-   **Formato de Email**: La dirección de email se convierte automáticamente a minúsculas y se eliminan los espacios en blanco.
